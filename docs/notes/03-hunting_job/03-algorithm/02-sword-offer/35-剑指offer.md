---
layout:  post
category:  algorithm
title:  No35ã€æ•°ç»„ä¸­çš„é€†æ’åº
tagline:  by é˜¿ç§€
tags:
    - åŸåˆ›
    - å‰‘æŒ‡offer
    - æ•°æ®ç»“æ„ä¸ç®—æ³•
    - ç®—æ³•
    - ç¤¾æ‹›
    - æ ¡æ‹›
    - é˜¿ç§€
excerpt: No35ã€æ•°ç»„ä¸­çš„é€†æ’åº
comment: false
---

<h1 align="center">å¸¦ä½ å¿«é€Ÿåˆ·å®Œ67é“å‰‘æŒ‡offer</h1>

<div style="border-color: #24C6DC;
            background-color: #e9f9f3;         
            margin: 1rem 0;
        padding: .25rem 1rem;
        border-left-width: .3rem;
        border-left-style: solid;
        border-radius: .5rem;
        color: inherit;">
  <p>è¿™æ˜¯å››åˆ™æˆ–è®¸å¯¹ä½ æœ‰å¸®åŠ©çš„è®¯æ¯</p>
  <p>1ã€ğŸ‘‰ æœ€è¿‘æˆ‘å‘ç°äº†ä¸€ä¸ªæ¯æ—¥æ¨é€éƒ½ä¼šæœ€æ–°æ ¡æ‹›å’¨è¯¢çš„<a style="text-decoration: underline" href="https://flowus.cn/ee50d5eb-3cd5-4f74-880e-95b215dd4ff2" target="_blank">ã€Šæ ¡æ‹›æ—¥ç¨‹ã€‹</a>æ–‡æ¡£ï¼ŒåŒ…æ‹¬å¤§å‚ã€å›½ä¼ã€é“¶è¡Œã€äº‹ä¸šç¼–ç­‰ä¿¡æ¯éƒ½ä¼šå®šæœŸæ›´æ–°ï¼Œå¸®å¿™æ‰©æ•£ä¸€ä¸‹ã€‚</p>  
  <p>2ã€ğŸ˜
    å…è´¹åˆ†äº«é˜¿ç§€ä¸ªäººå­¦ä¹ è®¡ç®—æœºä»¥æ¥çš„æ”¶é›†åˆ°çš„å…è´¹èµ„æºï¼Œ<a style="text-decoration: underline" href="/notes/07-resources/01-free/01-introduce.html" target="_blank">ç‚¹æ­¤ç™½å«–</a>ã€‚
  </p>
  <p>3ã€ğŸš€å¦‚æœä½ æƒ³åœ¨æ ¡æ‹›ä¸­é¡ºåˆ©æ‹¿åˆ°æ›´å¥½çš„offerï¼Œé˜¿ç§€å»ºè®®ä½ å¤šçœ‹çœ‹å‰äºº<a style="text-decoration: underline" href="https://www.yuque.com/tuobaaxiu/httmmc/npg1k81zeq4wfpyz" target="_blank">è¸©è¿‡çš„å‘</a>å’Œç•™ä¸‹çš„<a style="text-decoration: underline"  target="_blank" href="https://www.yuque.com/tuobaaxiu/httmmc/gge9ppd0mbu2d3dp">ç»éªŒ</a>ï¼Œäº‹å®ä¸Šä½ ç°åœ¨é‡åˆ°çš„å¤§å¤šæ•°é—®é¢˜ä½ çš„å­¦é•¿å­¦å§å¸ˆå…„å¸ˆå§åŸºæœ¬éƒ½å·²ç»é‡åˆ°è¿‡äº†ã€‚
  </p>
  <p>4ã€ğŸ”¥ æ¬¢è¿å‡†å¤‡è®¡ç®—æœºæ ¡æ‹›çš„å°ä¼™ä¼´åŠ å…¥æˆ‘çš„<a  style="text-decoration: underline" href="https://www.yuque.com/tuobaaxiu/httmmc/xg0otqvc17wfx4u9" target="_blank">å­¦ä¹ åœˆå­</a>ï¼Œä¸€ä¸ªäººè¸½è¸½ç‹¬è¡ŒçœŸçš„ä¸å¦‚ä¸€ç¾¤äººæŠ¥å›¢å–æš–ï¼Œå¥½å¥½èµ°ä¸‹å»åŸºæœ¬éƒ½èƒ½æ‹¿åˆ°ä¸é”™çš„offerï¼å¦‚æœä½ éœ€è¦ã€Šé˜¿ç§€çš„å­¦ä¹ ç¬”è®°ã€‹ç½‘ç«™ä¸­ğŸ“šï¸æ ¡æ‹›å…«è‚¡æ–‡ç›¸å…³çŸ¥è¯†ç‚¹çš„PDFç‰ˆæœ¬çš„è¯ï¼Œå¯ä»¥<a style="text-decoration: underline" href="/notes/08-other/02-question.html#_5ã€å¦‚ä½•ä¸‹è½½é˜¿ç§€çš„å­¦ä¹ ç¬”è®°å†…å®¹pdfç‰ˆæœ¬" target="_blank">ç‚¹æ­¤ä¸‹è½½</a> ã€‚</p>   </div>



## **No35ã€æ•°ç»„ä¸­çš„é€†æ’åº**

<font style="font-weight:normal; color:#4169E1;text-decoration:underline;" target="_blank">[ç‰›å®¢ç½‘åŸé¢˜é“¾æ¥](https://www.nowcoder.com/practice/96bd6684e04a44eb80e6a68efc0ec6c5?tpId=13&&tqId=11188&rp=1&ru=/ta/coding-interviews&qru=/ta/coding-interviews/question-ranking)</font>

### **é¢˜ç›®æè¿°**

åœ¨æ•°ç»„ä¸­çš„ä¸¤ä¸ªæ•°å­—ï¼Œå¦‚æœå‰é¢ä¸€ä¸ªæ•°å­—å¤§äºåé¢çš„æ•°å­—ï¼Œåˆ™è¿™ä¸¤ä¸ªæ•°å­—ç»„æˆä¸€ä¸ªé€†åºå¯¹ã€‚è¾“å…¥ä¸€ä¸ªæ•°ç»„,æ±‚å‡ºè¿™ä¸ªæ•°ç»„ä¸­çš„é€†åºå¯¹çš„æ€»æ•°Pã€‚å¹¶å°†På¯¹1000000007å–æ¨¡çš„ç»“æœè¾“å‡ºã€‚ å³è¾“å‡ºP%1000000007

**è¾“å…¥æè¿°**

é¢˜ç›®ä¿è¯è¾“å…¥çš„æ•°ç»„ä¸­æ²¡æœ‰çš„ç›¸åŒçš„æ•°å­—æ•°æ®èŒƒå›´ï¼š	å¯¹äº%50çš„æ•°æ®,size<=10^4	å¯¹äº%75çš„æ•°æ®,size<=10^5	å¯¹äº%100çš„æ•°æ®,size<=2*10^5

### **ç¤ºä¾‹1**

**è¾“å…¥**

```
1,2,3,4,5,6,7,0
```

**è¾“å‡º**

```
7
```



### **1ã€åªé€šè¿‡50%çš„ç¬¨æ–¹æ³•**

~~~cpp
    int InversePairs(vector<int> data) {
	if (data.size() <= 1) return 0;
	int len = data.size();
	vector<int> dp(len, 0);
	for (int i = len - 2; i >= 0; --i) {

		for (int j = i + 1; j < len; ++j) {
			if (data[i] > data[j]) { 
				//dp[i] = max(dp[i], dp[j] + 1); 
				dp[i]++;
			}

		}
	}

	return  accumulate(dp.begin(), dp.end(), 0) % 1000000007;
        
    }
~~~



### **2ã€ç‰›å®¢ä¸Šçš„ä¸€ç§åšæ³•ï¼Œå¾ˆå‰å®³**

https://www.nowcoder.com/profile/872855282/codeBookDetail?submissionId=78340272

~~~cpp
int InversePairs(vector<int> data) {
	if (data.size() == 0)
		return 0;
	vector<int> copy(data);    // è¾…åŠ©æ•°ç»„ï¼Œæ¯æ¬¡é€’å½’åæœ‰åº
	return InversePairsCore(data, copy, 0, data.size() - 1);
}

int InversePairsCore(vector<int>& data, vector<int>& copy, int begin, int end) {
	if (begin == end)
		return 0;
	int mid = begin + (end - begin) /2;
	int left = InversePairsCore(copy, data, begin, mid);//è¿™é‡Œçš„ä¸€æ­¥å¾ˆç»å•Šï¼Œå‡å°‘äº†äº¤æ¢çš„è¿™ä¸€æ­¥
	int right = InversePairsCore(copy, data, mid + 1, end);

	int end1 = mid;     // æ¯”è¾ƒä»å°¾ç«¯å¼€å§‹
	int end2 = end;    // æ¯”è¾ƒä»å°¾ç«¯å¼€å§‹
	int index_copy = end;       // æ¯”è¾ƒç»“æœå­˜å…¥è¾…åŠ©æ•°ç»„å°¾ç«¯
	long res = 0;

	// å½’å¹¶æ’åºï¼šç›¸å½“äºä¸¤ä¸ªæœ‰åºæ•°ç»„åˆæˆä¸€ä¸ªæœ‰åºè¡¨ï¼ˆä»å°¾ç«¯å¼€å§‹æ˜¯ä¸ºäº†è®¡æ•°ï¼‰
	while (begin<= end1 && mid + 1<= end2) {
		if (data[end1] > data[end2]) {
			copy[index_copy--] = data[end1--];
			res += end2 - mid;
			res %= 1000000007;
		}
		else
			copy[index_copy--] = data[end2--];
	}

	while (begin<= end1)
		copy[index_copy--] = data[end1--];
	while (mid + 1<= end2)
		copy[index_copy--] = data[end2--];

	return (left + right + res) % 1000000007;
}


~~~

InversePairsCore(copy, data, begin, mid)ä¸­ copyå’Œdataäº’æ¢ä½ç½®å¥½è¯„ã€‚ã€‚ã€‚è¿™æ ·å°±å‡å°‘äº†èµ‹å€¼çš„é‚£ä¸€æ­¥äº†ã€‚ã€‚ã€‚ã€‚ã€‚



### **äºŒåˆ·ï¼š**

### **1ã€å¾ˆæ£’çš„ä¸€é“é¢˜ç›®ï¼Œå»ºè®®å¤šåˆ·**

~~~cpp
int InversePairsCore(vector<int>& data, vector<int>& copy, int begin, int end) {
	if (begin == end)
		return 0;
	int mid = begin + (end - begin) / 2;
	int low1 = begin, high1 = mid, low2 = mid + 1, high2 = end;
	int left = InversePairsCore(copy, data, low1, high1);//è¿™é‡Œçš„ä¸€æ­¥å¾ˆç»å•Šï¼Œå‡å°‘äº†äº¤æ¢çš„è¿™ä¸€æ­¥
	int right = InversePairsCore(copy, data, low2, high2);

	long res = 0;
	int copyIndex = low1;
	// å½’å¹¶æ’åºï¼šç›¸å½“äºä¸¤ä¸ªæœ‰åºæ•°ç»„åˆæˆä¸€ä¸ªæœ‰åºè¡¨
	while (low1 <= high1 && low2 <= high2) {
		if (data[low1] > data[low2]) {
			copy[copyIndex++] = data[low1++];
			res += high2 - low2 + 1;// data[low1] > data[low2]ï¼Œé‚£ä¹ˆè¿™ä¸€æ¬¡ï¼Œä»a[i]å¼€å§‹åˆ°a[mid]å¿…å®šéƒ½æ˜¯å¤§äºè¿™ä¸ªa[j]çš„ï¼Œå› ä¸ºæ­¤æ—¶åˆ†æ²»çš„ä¸¤è¾¹å·²ç»æ˜¯å„è‡ªæœ‰åºäº†
			res %= 1000000007;
		}
		else
			copy[copyIndex++] = data[low2++];
	}

	while (low1 <= high1)
		copy[copyIndex++] = data[low1++];
	while (low2 <= high2)
		copy[copyIndex++] = data[low2++];

	return (left + right + res) % 1000000007;
}


int InversePairs(vector<int> data) {
	if (data.size() == 0)
		return 0;
	vector<int> copy(data);    // è¾…åŠ©æ•°ç»„ï¼Œæ¯æ¬¡é€’å½’åæœ‰åº
	return InversePairsCore(data, copy, 0, data.size() - 1);
}
~~~



### **2ã€å½’å¹¶æ’åºï¼Œå½’å¹¶æˆä»å°åˆ°å¤§çš„åºåˆ—ï¼Œè¿™ç§æ–¹æ³•æ›´å¥½ç†è§£ä¸€äº›**

è¿è¡Œæ—¶é—´ï¼š78ms  å ç”¨å†…å­˜ï¼š5788k

~~~cpp
int InversePairsCore(vector<int>& data, vector<int>& copy, int begin, int end) {
	if (begin == end)
		return 0;
	int mid = begin + (end - begin) / 2;
	int low1 = begin, high1 = mid, low2 = mid + 1, high2 = end;
	int left = InversePairsCore(copy, data, low1, high1);//è¿™é‡Œçš„ä¸€æ­¥å¾ˆç»å•Šï¼Œå‡å°‘äº†æ•°æ®äº¤æ¢çš„è¿™ä¸€æ­¥
	int right = InversePairsCore(copy, data, low2, high2);

	long res = 0;
	int copyIndex = low1;
	// å½’å¹¶æ’åºï¼šç›¸å½“äºä¸¤ä¸ªæœ‰åºæ•°ç»„åˆæˆä¸€ä¸ªæœ‰åºè¡¨
	//ä¸‹é¢å°±å¼€å§‹ä¸¤ä¸¤è¿›è¡Œæ¯”è¾ƒï¼Œè‹¥å‰é¢çš„æ•°å¤§äºåé¢çš„æ•°ï¼Œå°±æ„æˆé€†åºå¯¹
	while (low1 <= high1 && low2 <= high2) {
		if (data[low1] < data[low2]) {
			
			copy[copyIndex++] = data[low1++];
		}
		else//data[low1] >= data[low2]
		{
			copy[copyIndex++] = data[low2++];
			res += high1 - low1 + 1;
			res %= 1000000007;
		}
			
	}

	while (low1 <= high1)
		copy[copyIndex++] = data[low1++];
	while (low2 <= high2)
		copy[copyIndex++] = data[low2++];


	return (left + right + res) % 1000000007;
}


int InversePairs(vector<int> data) {
	if (data.size() == 0)
		return 0;
	vector<int> copy(data);    // è¾…åŠ©æ•°ç»„ï¼Œæ¯æ¬¡é€’å½’åæœ‰åº
	int res = InversePairsCore(data, copy, 0, data.size() - 1);
	
	//for (int a : data) {
	//	cout << a << " ";
	//}
	//cout << endl;

	//for (int a : copy) {
	//	cout << a << " ";
	//}
	//cout << endl;
	
	return res;

}
~~~



### **åŠ›æ‰£ä¸Šçš„å‰‘æŒ‡offerï¼š**

<font style="font-weight:normal; color:#4169E1;text-decoration:underline;" target="_blank">[å‰‘æŒ‡ Offer 51. æ•°ç»„ä¸­çš„é€†åºå¯¹](https://leetcode-cn.com/problems/shu-zu-zhong-de-ni-xu-dui-lcof/)</font>

åœ¨æ•°ç»„ä¸­çš„ä¸¤ä¸ªæ•°å­—ï¼Œå¦‚æœå‰é¢ä¸€ä¸ªæ•°å­—å¤§äºåé¢çš„æ•°å­—ï¼Œåˆ™è¿™ä¸¤ä¸ªæ•°å­—ç»„æˆä¸€ä¸ªé€†åºå¯¹ã€‚è¾“å…¥ä¸€ä¸ªæ•°ç»„ï¼Œæ±‚å‡ºè¿™ä¸ªæ•°ç»„ä¸­çš„é€†åºå¯¹çš„æ€»æ•°ã€‚

**ç¤ºä¾‹ 1:**

```
è¾“å…¥: [7,5,6,4]
è¾“å‡º: 5
```



**é™åˆ¶ï¼š**

```
0 <= æ•°ç»„é•¿åº¦ <= 50000
```

æ‰§è¡Œç”¨æ—¶ï¼š244 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†97.32%çš„ç”¨æˆ·

å†…å­˜æ¶ˆè€—ï¼š44.4 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†100.00%çš„ç”¨æˆ·

~~~cpp
 int reversePairsCore(vector<int>&nums, vector<int>&copy, int begin, int end){
        if(begin >= end) return 0;//ç»ˆæ­¢æ¡ä»¶
        int mid = begin + (end - begin)/2;
        int low1 = begin, high1 = mid, low2 = mid + 1,high2 = end;
        int leftRes = reversePairsCore(copy, nums, low1, high1);
        int rightRes = reversePairsCore(copy, nums, low2, high2);

        int copyIndex = low1,res = 0;
        while(low1 <= high1 && low2 <= high2){
            if(nums[low1] <= nums[low2])//è¿™é‡Œéœ€è¦ä¿æŒç»å¯¹çš„å°
            {
                copy[copyIndex++] = nums[low1++];
            }else{
                res += high1 - low1 + 1;//è¯´æ˜ [low1,high1]æ­¤æ—¶éƒ½æ˜¯å¤§äº nums[low2]çš„
                //è¿™é‡Œåƒä¸‡æ³¨æ„è¦ +1 ï¼Œå› ä¸ºhigh1 - low1 å°±å°‘ä¸€ä¸ª æ¯”å¦‚ 3-0 = 4ï¼Œä½†å…¶å®æ˜¯4ä¸ªæ•°
                copy[copyIndex++] = nums[low2++];
            }

        }
        while(low1 <= high1)
            copy[copyIndex++] = nums[low1++];

        while(low2 <= high2)
            copy[copyIndex++] = nums[low2++];

        return res + leftRes + rightRes;

    }



    int reversePairs(vector<int>& nums) {
        if( nums.size() <= 1) return 0;
        vector<int> copy(nums);
        return reversePairsCore(nums,copy,0,nums.size()-1);

    }
~~~

 å½’å¹¶ç±»é¢˜ç›®ï¼š

åŠ›æ‰£ç¬¬315/327/493é“ 


<p id = "æ•°ç»„ä¸­çš„é€†æ’åº"></p>

